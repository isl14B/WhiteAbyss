{% extends "base.html" %}

{% block content %}
    <h1>Result画面</h1>

    結果を表示<br><br>

    {% for name, version, search_result in result_list %}
        <div id="plugin_{{ forloop.counter }}" class="pluginClass">
            {{ name }}
        </div>

        <div id="selection_{{ forloop.counter }}">
        {% for i in search_result %}
            <div class="vulnerabilityClass" id={{ forloop.counter }}>
                {{ i }}
{#                {{ i.Exploit }}<br>#}
{#                {{ i.Path }}<br>#}
            </div>
        {% endfor %}
        </div>
    {% endfor %}

<script>
    // 最初に脆弱性情報要素の位置を，プラグイン要素の位置に移動
    window.onload = function() {
        for (var i = 1; i <={{ plugin_num }}; i++) {
            var pos = $("#plugin_" + i).offset().top;
            var select = "#selection_" + i + ">div";
            $(select).each(function (index, elem) {
                $(elem).offset({top: pos});
            });
        }
    }

    // num番目のプラグイン要素をクリックした場合，num番目の小要素（脆弱性要素）を横にスライドさせる
    $(".pluginClass").click(function(){
        var num = this.id.split("_")[1];
        setPosFunc(num);
    });

    function setPosFunc(number){
        var posNo = 1;
        var select = "#selection_" + number + ">div";
        $(select).each(function(index, elem) {
            var myX = posNo * 150 + "px";
            $(elem).stop().animate({left: myX});
            posNo+=1;
        });
    }
</script>
{% endblock %}


